---
title: Stiffiness Matrix
layout: home
nav_order: 7
parent: MEF 1D
---

<!--Don't delete this script-->
<script src = "https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id = "MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!--Don't delete this script-->

ELEMENT_STIFFNESS_0
{: .label .label-green }

<p align = "justify">
This function creates the element stiffness matrix of the \(i\) frame element.
</p>

Input variables
{: .label .label-blue }

<table style = "width:100%">
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Type</th>
      </tr>
    </thead>
    <tr>
        <td>TYPE_ELEMENT</td>
        <td>Type element in Finito algorithm</td>
        <td>Integer</td>
    </tr>
    <tr>
        <td>SECTION_IELEMENT</td>
        <td>Section I_ELEMENT properties</td>
        <td>Py list</td>
    </tr>  
    <tr>
        <td><i>[0]</i></td>
        <td>Length element</td>
        <td>Float</td>
    </tr>  
    <tr>
        <td><i>[1]</i></td>
        <td>Sine</td>
        <td>Float</td>
    </tr>
    <tr>
        <td><i>[2]</i></td>
        <td>Cosine</td>
        <td>Float</td>
    </tr>  
    <tr>
        <td><i>[3]</i></td>
        <td>Cross-sectional area I_ELEMENT </td>
        <td>Float</td>
    </tr>
    <tr>
        <td><i>[4]</i></td>
        <td>Inertia auxiliar</td>
        <td>Float</td>
    </tr>
    <tr>
        <td><i>[5]</i></td>
        <td>Inertia frame element \(i\) </td>
        <td>Float</td>
    </tr>        
    <tr>
        <td>MATERIAL_IELEMENT</td>
        <td>Material I_ELEMENT properties</td>
        <td>Py list</td>
    </tr>  
    <tr>
        <td><i>[0]</i></td>
        <td>Young</td>
        <td>Float</td>
    </tr>  
    <tr>
        <td><i>[1]</i></td>
        <td>Shear modulus</td>
        <td>Float</td>
    </tr>
    <tr>
        <td><i>[2]</i></td>
        <td>Poisson</td>
        <td>Float</td>
    </tr>  
    <tr>
        <td><i>[3]</i></td>
        <td>Thermal coefficient</td>
        <td>Float</td>
    </tr>
    <tr>
        <td><i>[4]</i></td>
        <td>Density</td>
        <td>Float</td>
    </tr>
    <tr>
        <td>HINGES_IELEMENT</td>
        <td>Hinge properties per node of element \(i\)</td>
        <td>Py list</td>
    </tr>  
    <tr>
        <td><i>[1]</i></td>
        <td>Shear modulus</td>
        <td>Integer</td>
    </tr>
    <tr>
        <td><i>[2]</i></td>
        <td>Poisson</td>
        <td>Integer</td>
    </tr>
</table>

Output variables
{: .label .label-blue }
<table style = "width:100%">
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Type</th>
      </tr>
    </thead>
    <tr>
        <td>K_IELEMENT</td>
        <td>Local stiffness matrix I_ELEMENT</td>
        <td>Py Numpy array</td>
    </tr>
</table>

Function
{: .label .label-blue }

``` python

import numpy as np

def ELEMENT_STIFFNESS_0(TYPE_ELEMENT, SECTION_IELEMENT, MATERIAL_IELEMENT, HINGES_IELEMENT):
  
    if (TYPE_ELEMENT == 0 and HINGES_IELEMENT[0] == 0 and HINGES_IELEMENT[1] == 0):
        L = SECTION_IELEMENT[0]
        A = SECTION_IELEMENT[3]
        I = SECTION_IELEMENT[5]
        E = MATERIAL_IELEMENT[0]
        C1 = A * E / L
        C2 = E * I / L ** 3
        K_IELEMENT = np.array([[C1, 0, 0, -C1, 0, 0],
                               [0, 12 * C2, 6 * C2 * L, 0, -12 * C2, 6 * C2 * L],
                               [0, 6 * C2 * L, 4 * C2 * L ** 2, 0, -6 * C2 * L, 2 * C2 * L ** 2],
                               [-C1, 0, 0, C1, 0, 0],
                               [0, -12 * C2, -6 * C2 * L, 0, 12 * C2, -6 * C2 * L],
                               [0, 6 * C2 * L, 2 * C2 * L ** 2, 0, -6 * C2 * L, 4 * C2 * L **2]])
    elif (TYPE_ELEMENT == 0 and HINGES_IELEMENT[0] == 0 and HINGES_IELEMENT[1] == 1):
        L = SECTION_IELEMENT[0]
        A = SECTION_IELEMENT[3]
        I = SECTION_IELEMENT[5]
        E = MATERIAL_IELEMENT[0]
        C1 = A * E / L
        C2 = E * I / (L ** 3)
        K_IELEMENT = np.array([[C1, 0, 0, -C1, 0, 0],
                               [0, 3 * C2, 3 * C2 * L, 0, -3 * C2, 0],
                               [0, 3 * C2 * L, 3 * C2 * L ** 2, 0, -3 * C2 * L, 0],
                               [-C1, 0, 0, C1, 0, 0],
                               [0, -3 * C2, -3 * C2 * L, 0, 3 * C2, 0],
                               [0, 0, 0, 0, 0, 0]])    
    elif (TYPE_ELEMENT == 0 and HINGES_IELEMENT[0] == 1 and HINGES_IELEMENT[1] == 0):
        L = SECTION_IELEMENT[0]
        A = SECTION_IELEMENT[3]
        I = SECTION_IELEMENT[5]
        E = MATERIAL_IELEMENT[0]
        C1 = A * E / L
        C2 = E * I / (L ** 3)
        K_IELEMENT = np.array([[C1, 0, 0, -C1, 0, 0],
                               [0, 3 * C2, 0, 0, -3 * C2, 3 * C2 * L],
                               [0, 0, 0, 0, 0, 0],
                               [-C1, 0, 0, C1, 0, 0],
                               [0, -3 * C2, 0, 0, 3 * C2, -3 * C2 * L],
                               [0, 3 * C2 * L, 0, 0, -3 * C2 * L, 3 * C2 * L **2]])     
    elif (TYPE_ELEMENT == 0 and HINGES_IELEMENT[0] == 1 and HINGES_IELEMENT[1] == 1):
        L = SECTION_IELEMENT[0]
        A = SECTION_IELEMENT[3]
        I = SECTION_IELEMENT[5]
        E = MATERIAL_IELEMENT[0]
        C1 = A * E / L
        C2 = E * I / (L ** 3)
        K_IELEMENT = np.array([[C1, 0, 0, -C1, 0, 0],
                              [0, 0, 0, 0, 0, 0],
                              [0, 0, 0, 0, 0, 0],
                              [-C1, 0, 0, C1, 0, 0],
                              [0, 0, 0, 0, 0, 0],
                              [0, 0, 0, 0, 0, 0]])
    return K_IELEMENT

```

Example
{: .label .label-blue }

<p align = "justify">Demonstrate the stffiness matrix about frame element:

<br>(a) Comprimento do elemente de 3 m ($L=3 m$)</br>
<br>(b) Ângulo em relação ao eixo x de 30°  ($sin = 0.5$ and $cos = 0.8660254038$)</br>
<br>(c) Seção transversal retangular de 0.1 m por 0.3 m ($ A = 0.1 \cdot 0.3 $  and $ I  = \frac{0.2 \cdot 0.3 ^3 }{12}$)</br>

<br>(d) Propriedade do material \( $ E =  210\cdot 10^6 $ kPa, $ G = 77\cdot 10^6 $ kPa, $\nu = 0.3$, $ \alpha = 1 \cdot 10^{-5} \degree C^{-1} $ and $$ \)</br>
<br>(e) (L=3 m\)</br>
</p>

```python
# Data
TYPE_ELEMENT = 0
SECTION_IELEMENT = [3, 0.5 , 0.8660254038, 0.1*0.3, 0.1*0.3**3/12, 0.1*0.3**3/12]
MATERIAL_IELEMENT = [210e6, 77e6, 0.3, 0.00001, 78500]
HINGES_IELEMENT = [0,0]

# Call function
K_IELEMENT = ELEMENT_STIFFNESS_0(TYPE_ELEMENT, SECTION_IELEMENT, MATERIAL_IELEMENT, HINGES_IELEMENT)

# Print result
print(K_IELEMENT)
```
<p align = "justify">
Result

</p>

```shell

[[ 2100000,      0,      0.  -2100000,      0,      0]
 [       0,  21000,  31500,         0, -21000,  31500]
 [       0,  31500,  63000,         0, -31500,  31500]
 [-2100000,      0,      0,   2100000,      0,      0]
 [       0, -21000, -31500,         0,  21000, -31500]
 [       0,  31500,  31500,         0, -31500,  63000]]
```